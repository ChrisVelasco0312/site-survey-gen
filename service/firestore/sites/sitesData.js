/**
 * Datos de sitios LPR y Cotejo Facial para poblar la colección `sites` en Firestore.
 * Coordenadas en grados decimales (lat, lng). Fuente: docs/Base de datos sitios.md
 */

/** Convierte DMS (ej. "3°31'28\"N 76°20'14\"W" o "3°23'45.82\"N 76°22'41.30\"O") a [lat, lng] en decimal. */
function parseDMS(dmsStr) {
  if (!dmsStr || typeof dmsStr !== 'string') return [null, null];
  const normalized = dmsStr.replace(/"/g, '"').replace(/''/g, "'").trim();
  const latMatch = normalized.match(/(\d+)°\s*(\d+)'?\s*([\d.]+)"?\s*([NS])/i);
  const lngRegex = /(\d+)°\s*(\d+)'?\s*([\d.]+)"?\s*([OWE])/gi;
  const lngMatch = lngRegex.exec(normalized);
  if (!latMatch || !lngMatch) return [null, null];
  const lat = parseInt(latMatch[1], 10) + parseInt(latMatch[2], 10) / 60 + parseFloat(latMatch[3]) / 3600;
  const lng = parseInt(lngMatch[1], 10) + parseInt(lngMatch[2], 10) / 60 + parseFloat(lngMatch[3]) / 3600;
  const latSign = latMatch[4].toUpperCase() === 'S' ? -1 : 1;
  const lngSign = (lngMatch[4].toUpperCase() === 'W' || lngMatch[4].toUpperCase() === 'O') ? -1 : 1;
  return [latSign * lat, lngSign * lng];
}

/** LPR: Punto, Distrito, Municipio, Dirección, Coordenadas (DMS), Cant. Cámaras (tabla con cámaras) */
const lprRows = [
  ['LPR 1', 'DISTRITO PALMIRA', 'PALMIRA', 'La recta Cali Palmira', "3°31'28\"N 76°20'14\"W", 4],
  ['LPR 2', 'DISTRITO MECAL', 'CANDELARIA', 'Candelaria Crucero', "3°23'44\"N 76°21'13\"W", 4],
  ['LPR 3', 'DISTRITO BUGA', 'YOTOCO', 'Media Canoa Glorieta', "3°53'33\"N 76°22'08\"W", 2],
  ['LPR 4', 'DISTRITO DAGUA', 'DAGUA', 'Descanso del ciclista (Vía Media Canoa)', "3°53'10\"N 76°24'22\"W", 2],
  ['LPR 5', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Zabaletas', "3°48'44\"N 76°37'18\"W", 2],
  ['LPR 6', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Lobo Guerrero - Cerca al peaje', "3°45'53\"N 76°40'02\"W", 2],
  ['LPR 7', 'DISTRITO MECAL', 'CANDELARIA', 'Entrada Villa Gorgona', "3°23'45.82\"N 76°22'41.30\"O", 2],
  ['LPR 8', 'DISTRITO CARTAGO', 'CARTAGO', 'Zaragoza', "3°51'39\"N 76°51'20\"W", 1],
  ['LPR 9', 'DISTRITO MECAL', 'CANDELARIA', 'Entrada Poblado Campestre', "3°24'46.34\"N 76°27'8.58\"O", 2],
  ['LPR 10', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Córdoba Salida', "3°52'47\"N 76°55'32\"W", 1],
  ['LPR 11', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Buenaventura CONFAMAR', "3°52'47\"N 76°55'32\"W", 2],
  ['LPR 12', 'DISTRITO BUGA', 'BUGA', 'Picapiedra (Vía Media Canoa – La Virginia)', "3°53'27\"N 76°21'39\"W", 2],
  ['LPR 13', 'DISTRITO BUGA', 'BUGA', 'Buga SENA', "3°53'35\"N 76°18'42\"W", 2],
  ['LPR 14', 'DISTRITO BUGA', 'SAN PEDRO', 'San Pedro', "3°59'42\"N 76°13'56\"W", 2],
  ['LPR 15', 'DISTRITO TULUÁ', 'TULUÁ', 'Tuluá entrada y salida sur', "4°03'12\"N 76°12'05\"W", 2],
  ['LPR 16', 'DISTRITO TULUÁ', 'TULUÁ', 'Tuluá entrada y salida norte', "4°05'48\"N 76°10'31\"W", 2],
  ['LPR 17', 'DISTRITO TULUÁ', 'BUGALAGRANDE', 'La Uribe Cruce Sevilla', "4°15'22\"N 76°06'52\"W", 2],
  ['LPR 18', 'DISTRITO ROLDANILLO', 'ZARZAL', 'La Paila Cruce Corozal', "4°19'51\"N 76°04'10\"W", 2],
  ['LPR 19', 'DISTRITO SEVILLA', 'SEVILLA', 'Corozal', "4°23'56\"N 75°55'14\"W", 1],
  ['LPR 20', 'DISTRITO CARTAGO', 'LA VICTORIA', 'La Victoria Palo de Leche', "4°29'27\"N 76°01'42\"W", 1],
  ['LPR 21', 'DISTRITO CARTAGO', 'CARTAGO', 'Zaragoza', "4°42'12\"N 75°55'27\"W", 1],
  ['LPR 22', 'DISTRITO CARTAGO', 'CARTAGO', 'Cartago ingreso', "4°43'56\"N 75°54'43\"W", 4],
  ['LPR 23', 'DISTRITO CARTAGO', 'ANSERMANUEVO', 'Anserma Nuevo Glorieta', "4°47'25\"N 75°58'36\"W", 1],
  ['LPR 24', 'DISTRITO ROLDANILLO', 'TORO', 'Toro Peaje', "4°39'55\"N 76°02'58\"W", 1],
  ['LPR 25', 'DISTRITO ROLDANILLO', 'LA UNIÓN', 'La Unión Glorieta', "4°31'49\"N 76°05'11\"W", 1],
  ['LPR 26', 'DISTRITO ROLDANILLO', 'ROLDANILLO', 'Roldanillo Glorieta', "4°24'54\"N 76°08'40\"W", 1],
  ['LPR 27', 'DISTRITO TULUÁ', 'RIO FRIO', 'Rio Frio Glorieta', "4°08'54\"N 76°16'48\"W", 1],
  ['LPR 28', 'DISTRITO PALMIRA', 'FLORIDA', 'Florida', "3°17'59.15\"N 76°13'51.38\"O", 2],
  ['LPR 29', 'DISTRITO PALMIRA', 'PALMIRA', 'Palmira', "3°37'15.53\"N 76°26'47.42\"O", 2],
];

/** Cotejo Facial: Punto, Distrito, Municipio, Dirección, Coordenadas (tabla actualizada) */
const cotejoFacialRows = [
  ['F.1', 'DISTRITO BUGA', 'BUGA', 'Entrada Alcaldía de Buga, Cra. 13A Sur #6-50', "3°53'58\"N 76°18'04\"W"],
  ['F.2', 'DISTRITO BUGA', 'BUGA', 'Distrito de policía Buga, Cra. 14a #1 Sur-2 a 1 Sur-70', "3°53'36\"N 76°18'13\"W"],
  ['F.3', 'DISTRITO BUGA', 'BUGA', 'C.C. Buga Plaza, Cl. 4 #23 – 86', "3°54'02\"N 76°18'39\"W"],
  ['F.4', 'DISTRITO BUGA', 'BUGA', 'Calle 1 carrera 11, zona rosa', "3°53'40\"N 76°18'00\"W"],
  ['F.5', 'DISTRITO BUGA', 'BUGA', 'Cra. 12 salida sur, Vía Quebrada Seca, centro recreativo', "3°52'52\"N 76°17'57\"W"],
  ['F.6', 'DISTRITO BUGA', 'BUGA', 'Cra. 13 entra calle 8 y 9, centro', "3°54'02\"N 76°18'00\"W"],
  ['F.7', 'DISTRITO TULUÁ', 'TULUÁ', 'Palacio de justicia Tuluá, Cl. 25 #26-46', "4°05'07\"N 76°11'44\"W"],
  ['F.8', 'DISTRITO TULUÁ', 'TULUÁ', 'C.C. La Herradura, Cra. 19 #28-76', "4°05'02\"N 76°12'12\"W"],
  ['F.9', 'DISTRITO TULUÁ', 'TULUÁ', 'C.C. Mall Plaza, Cra. 40 #37-51', "4°04'23\"N 76°11'25\"W"],
  ['F.10', 'DISTRITO TULUÁ', 'TULUÁ', 'Secretaria de Transito Tuluá, Cra. 30 callejón morales', "4°05'44\"N 76°11'18\"W"],
  ['F.11', 'DISTRITO TULUÁ', 'TULUÁ', 'Coliseo de ferias, Cl. 13 #41-185', "4°05'41\"N 76°11'12\"W"],
  ['F.12', 'DISTRITO TULUÁ', 'TULUÁ', 'C.C. Bicentenario, Cl. 28 #19-38', "4°05'02\"N 76°12'06\"W"],
  ['F.13', 'DISTRITO PALMIRA', 'PALMIRA', 'Coliseo de ferias, Cra. 24 #19-00', "3°31'05\"N 76°17'44\"W"],
  ['F.14', 'DISTRITO PALMIRA', 'PALMIRA', 'Parque del azúcar, Cl. 42 #35 esquina', "3°32'21\"N 76°18'27\"W"],
  ['F.15', 'DISTRITO PALMIRA', 'PALMIRA', 'C.C. Llano Grande, Cl. 31 #44-239', "3°31'44\"N 76°19'00\"W"],
  ['F.16', 'DISTRITO PALMIRA', 'PALMIRA', 'C.C. Unicentro, Cl. 42 #39-68', "3°32'22\"N 76°18'37\"W"],
  ['F.17', 'DISTRITO PALMIRA', 'PALMIRA', 'Alcaldía, Cl. 39 con Cra. 39 esquina', "3°31'37\"N 76°18'00\"W"],
  ['F.18', 'DISTRITO PALMIRA', 'PALMIRA', 'Secretaria de tránsito, Cra. 35 #42-291', "3°32'30\"N 76°18'26\"W"],
  ['F.19', 'DISTRITO CARTAGO', 'CARTAGO', 'Alcaldía, Cl. 8 #6-52', "4°44'52\"N 75°54'34\"W"],
  ['F.20', 'DISTRITO CARTAGO', 'CARTAGO', 'Palacio de justicia, Cl. 11 #4-29', "4°44'55\"N 75°54'45\"W"],
  ['F.21', 'DISTRITO CARTAGO', 'CARTAGO', 'Parque Simón Bolívar', "4°44'58\"N 75°54'46\"W"],
  ['F.22', 'DISTRITO CARTAGO', 'CARTAGO', 'C.C. Nuestro Cartago, Cl. 34 #2-45', "4°45'25\"N 75°56'01\"W"],
  ['F.23', 'DISTRITO CARTAGO', 'CARTAGO', 'Registraduría, Cl. 14 entre Cra 5 y 6', "4°44'54\"N 75°54'57\"W"],
  ['F.24', 'DISTRITO CARTAGO', 'CARTAGO', 'Santiago Plaza, Cl. 14 #11-19', "4°44'33\"N 75°54'56\"W"],
  ['F.25', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Alcaldía, Cl. 2 con Cra. 3', "3°53'16\"N 77°04'37\"W"],
  ['F.26', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Muelle turístico', "3°53'20\"N 77°04'49\"W"],
  ['F.27', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Terminal transporte, Cra. 5 #7-32', "3°53'23\"N 77°04'25\"W"],
  ['F.28', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Secretaria de tránsito, Cra. 10 #5ª-2', "3°53'07\"N 77°04'14\"W"],
  ['F.29', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'C.C. Bellavista, Cl. 5b #45-64', "3°52'57\"N 77°01'13\"W"],
  ['F.30', 'DISTRITO BUENAVENTURA', 'BUENAVENTURA', 'Viva Centro Comercial, Cl. 5b #45-64', "3°52'03\"N 76°59'49\"W"],
  ['F.31', 'DISTRITO TULUÁ', 'TRUJILLO', 'Alcaldía, Cl. 20 #19-01', "4°12'45\"N 76°19'05\"W"],
  ['F.32', 'DISTRITO BUGA', 'CALIMA', 'Alcaldía, Cl. 10 #6-25', "3°55'52\"N 76°29'03\"W"],
];


const ptzRows = [
  ['1', 'P1', 'DISTRITO CARTAGO', 'Alcalá', 'Carrera 13 con Calle 4 Barrio la Palmas', 4.674665, -75.785504],
  ['2', 'P2', 'DISTRITO CARTAGO', 'Alcalá', 'Carrera 9 con Calle 6 Barrio Centro', 4.67505, -75.78265],
  ['3', 'P3', 'DISTRITO CARTAGO', 'Alcalá', 'Carrera 5 con Calle 6 Barrio Porvenir', 4.674747, -75.779452],
  ['4', 'P1', 'DISTRITO CARTAGO', 'Ulloa', 'Carrera 3 con Calle 5 Barrio Villa Montana', 4.702986, -75.737719],
  ['5', 'P3', 'DISTRITO CARTAGO', 'Ulloa', 'Carrera 4 con Calle 6 Barrio Villa Sucre', 4.701712, -75.737269],
  ['6', 'P1', 'DISTRITO CARTAGO', 'Obando', 'Carrera 4E Calle 2 sagrada familia', 4.574966, -75.969933],
  ['7', 'P2', 'DISTRITO CARTAGO', 'Obando', 'Carrera 3 con calle 1 san fernando', 4.574898, -75.970009],
  ['8', 'P3', 'DISTRITO CARTAGO', 'Obando', 'Carrera 4 calle 1 Barrio Triunfo', 4.569981, -75.974821],
  ['9', 'P1', 'DISTRITO CARTAGO', 'El Cairo', 'Carrera 4 con Calle 8 Barrio Centro', 4.761593, -76.220878],
  ['10', 'P4', 'DISTRITO CARTAGO', 'El Cairo', 'Carrera 5 con Calle 5 Barrio Trocadero', 4.760702, -76.222576],
  ['11', 'P3', 'DISTRITO CARTAGO', 'Argelia', 'Carrera 4 con calle 2 Barrio Aparicio', 4.726932, -76.1202],
  ['12', 'P4', 'DISTRITO CARTAGO', 'Argelia', 'Carrera 7 con calle 6 Barrio Moserrate', 4.727526, -76.122474],
  ['13', 'P2', 'DISTRITO CARTAGO', 'La Victoria', 'Carrera 6 con Calle 10 Barrio Santa Teresa', 4.524476, -76.035191],
  ['14', 'P3', 'DISTRITO CARTAGO', 'La Victoria', 'Carrera 7 con Calle 8 Barrio Occidente', 4.522952, -76.036231],
  ['15', 'P4', 'DISTRITO CARTAGO', 'La Victoria', 'Carrera 8 con Calle 6 Barrio Occidente', 4.521434, -76.037218],
  ['16', 'P1', 'DISTRITO CARTAGO', 'El Águila', 'Carrera 3a con calle 14 sector del hospital', 4.910833333333334, -76.04083333333332],
  ['17', 'P2', 'DISTRITO CARTAGO', 'El Águila', 'Carrera 7 con calle 11ª Barrio San Vicente', 4.910833333333334, -76.0425],
  ['18', 'P3', 'DISTRITO CARTAGO', 'El Águila', 'Carrera 3ª con calle 2 Barrio Asprodica', 4.905555555555556, -76.04333333333334],
  ['19', 'P1', 'DISTRITO CARTAGO', 'Ansermanuevo', 'calle  2 con carrera 3 esquina estacion de servicio brio', 4.791674, -75.993305],
  ['20', 'P2', 'DISTRITO CARTAGO', 'Ansermanuevo', 'Carrera 1 con calle 8 Barrio palerma', 4.795667, -75.990804],
  ['21', 'P3', 'DISTRITO CARTAGO', 'Ansermanuevo', 'Calle 2  con carrera 1 Barrio Gramalote', 4.791674, -75.99353],
  ['22', 'P1', 'DISTRITO ROLDANILLO', 'Roldanillo', 'Carrera 8 con calle 9 JJ Jaramillo', 4.410055555555556, -76.15319444444445],
  ['23', 'P2', 'DISTRITO ROLDANILLO', 'Roldanillo', 'Carrera 11 con calle 4 Barrio Llanitos', 4.408111111111111, -76.15380555555556],
  ['24', 'P3', 'DISTRITO ROLDANILLO', 'Roldanillo', 'Carrera 2 con calle 7 B Barrio Torrijos', 4.415916666666667, -76.15380555555556],
  ['25', 'P4', 'DISTRITO ROLDANILLO', 'Roldanillo', 'carrera 2 con calle 16 Universidad Antonio Nariño', 4.415361111111111, -76.14511111111112],
  ['26', 'P5', 'DISTRITO ROLDANILLO', 'Roldanillo', 'Calle 9 con carrera 2 norte esquina', 4.417777777777778, -76.15083333333334],
  ['27', 'P1', 'DISTRITO ROLDANILLO', 'Toro', 'Carrera 4 con Calle 11 Barrio la Troncada', 4.610334, -76.078407],
  ['28', 'P2', 'DISTRITO ROLDANILLO', 'Toro', 'Carrera 2 con Calle 7 Barrio Centro', 4.608751, -76.082355],
  ['29', 'P1', 'DISTRITO ROLDANILLO', 'Versalles', 'Entrada urbanizacion el bosque', 4.574453, -76.203191],
  ['30', 'P2', 'DISTRITO ROLDANILLO', 'Versalles', 'carrera 1 con calle 8 Barrio Guayabito', 4.575771, -76.196111],
  ['31', 'P1', 'DISTRITO ROLDANILLO', 'El Dovio', 'Carrera 7 con Calle 6 Barrio Nicolas Olano', 4.512283, -76.238444],
  ['32', 'P2', 'DISTRITO ROLDANILLO', 'El Dovio', 'Carrera 8 con Calle 7 Barrio Nicolas Olano', 4.511439, -76.23766],
  ['33', 'P3', 'DISTRITO ROLDANILLO', 'El Dovio', 'Carrera 7 con Calle 7 Barrio Nicolas Olano', 4.511514, -76.238486],
  ['34', 'P4', 'DISTRITO ROLDANILLO', 'El Dovio', 'Carrera 6 con Calle 6 Barrio Nicolas Olano', 4.512359, -76.239076],
  ['35', 'P1', 'DISTRITO ROLDANILLO', 'Zarzal', 'calle 10 con carrera 3', 4.232617, -76.040296],
  ['36', 'P2', 'DISTRITO ROLDANILLO', 'Zarzal', 'carrera 11 con calle 5', 4.232923, -76.043079],
  ['37', 'P3', 'DISTRITO ROLDANILLO', 'Zarzal', 'calle 5 con carrera 5', 4.232617, -76.040296],
  ['38', 'P4', 'DISTRITO ROLDANILLO', 'Zarzal', 'carrera 4 calle 7c', 4.234538, -76.042902],
  ['39', 'P1', 'DISTRITO ROLDANILLO', 'La Unión', 'Ciudadela carrera 15 con calle 8', 4.31357, -76.06183],
  ['40', 'P2', 'DISTRITO ROLDANILLO', 'La Unión', 'Galeria y Talleres Carrera 16 con Calle 19', 4.32091, -76.0613],
  ['41', 'P3', 'DISTRITO ROLDANILLO', 'La Unión', 'Parque y Estacion Carrera 14 Calle 15', 4.31557, -76.06098],
  ['42', 'P4', 'DISTRITO ROLDANILLO', 'La Unión', 'Calle 21 con Carrera 24', 4.32213, -76.06376],
  ['43', 'P1', 'DISTRITO ROLDANILLO', 'Bolívar', 'Carrera 5 con calle 5 Barrio el Centro', 4.337771, -76.184979],
  ['44', 'P2', 'DISTRITO ROLDANILLO', 'Bolívar', 'Carrera 5 con calle 7 Barrio la Paz', 4.339248, -76.184394],
  ['45', 'P3', 'DISTRITO ROLDANILLO', 'Bolívar', 'Carrera 2 con calle 7 Barrio Camellon', 4.338408, -76.182104],
  ['46', 'P1', 'DISTRITO SEVILLA', 'Sevilla', 'Carrera 50 con Calle 51 Barrio la Concordia', 4.264592, -75.934091],
  ['47', 'P2', 'DISTRITO SEVILLA', 'Sevilla', 'Carrera 48 con Calle 53 Barrio Obrero', 4.266433, -75.932417],
  ['48', 'P3', 'DISTRITO SEVILLA', 'Sevilla', 'Carrera 51 con Calle 56 Barrio el Carmen', 4.268958, -75.934477],
  ['49', 'P4', 'DISTRITO SEVILLA', 'Sevilla', 'Carrera 52A con calle 59 Barrio Belen', 4.27243, -75.935592],
  ['50', 'P1', 'DISTRITO SEVILLA', 'Caicedonia', 'Carrera 10 con 12', 4.200748, -75.49597],
  ['51', 'P2', 'DISTRITO SEVILLA', 'Caicedonia', 'carrera 16 calle 2 el surco', 4.193609, -75.494253],
  ['52', 'P3', 'DISTRITO SEVILLA', 'Caicedonia', 'carrera 9 calle 6  barrio Santander', 4.195348, -75.492609],
  ['53', 'P1', 'DISTRITO BUGA', 'Buga', 'Calle 32a con Carrera 13 - B/ Balboa', 3.9204388888888886, -76.2928],
  ['54', 'P2', 'DISTRITO BUGA', 'Buga', 'Carrera 9 con Calle 14 - B/ Santa Bárbara', 3.9045722222222223, -76.29468055555556],
  ['55', 'P3', 'DISTRITO BUGA', 'Buga', 'Carrera 7E con Calle 12 - B/ Alto Bonito - Parque', 3.9017916666666665, -76.29340833333333],
  ['56', 'P4', 'DISTRITO BUGA', 'Buga', 'Carrera 12 con Calle 33b – Entrada Uninorte', 3.9207277777777776, -76.29163888888888],
  ['57', 'P5', 'DISTRITO BUGA', 'Buga', 'Carrera 1 con Calle 13a - B/ La Revolución', 3.9010777777777776, -76.28936388888889],
  ['58', 'P6', 'DISTRITO BUGA', 'Buga', 'Carrera 16 con Calle 21 - Roundpoint', 3.9129055555555556, -76.29883055555555],
  ['59', 'P7', 'DISTRITO BUGA', 'Buga', 'Calle 22a con Carrera 13 - Parque María Luisa', 3.9127666666666667, -76.29611944444444],
  ['60', 'P8', 'DISTRITO BUGA', 'Buga', 'Carrera 25 Con Calle 16 B/ Palo Blanco - Puente', 3.9150027777777776, -76.2980361111111],
  ['61', 'P9', 'DISTRITO BUGA', 'Buga', 'Carrera 12 salida sur Brisas', 3.8608722222222225, -76.29621666666667],
  ['62', 'P10', 'DISTRITO BUGA', 'Buga', 'Carrera 12 con Calle 8 B/ José María Cabal', 3.902336111111111, -76.29471111111111],
  ['63', 'P1', 'DISTRITO BUGA', 'San Pedro', 'Carrera 6 con Calle 7 Barrio Jorge Herrera', 3.9982450000000003, -76.22836194444444],
  ['64', 'P2', 'DISTRITO BUGA', 'San Pedro', 'Calle 2 con Carrera 1A Barrio El Espinal', 3.993175, -76.22427083333334],
  ['65', 'P3', 'DISTRITO BUGA', 'San Pedro', 'Calle 3 con Carrera 6 Barrio Centro', 3.994456111111111, -76.22958777777778],
  ['66', 'P1', 'DISTRITO BUGA', 'Calima Darién', 'Carrera 2E con calle 7', 3.927127, -76.480993],
  ['67', 'P2', 'DISTRITO BUGA', 'Calima Darién', 'Carrera 7 con calle 7', 3.929761, -76.485644],
  ['68', 'P3', 'DISTRITO BUGA', 'Calima Darién', 'Carrera 7 con calle 5 via al lago', 3.927359, -76.486703],
  ['69', 'P4', 'DISTRITO BUGA', 'Calima Darién', 'Calle 11 con 1 por el cementerio entrada a la cancha', 3.932317, -76.4842788],
  ['70', 'P5', 'DISTRITO BUGA', 'Calima Darién', 'Sector 5 Lago Calima', 3.7145436, -76.49112],
  ['71', 'P6', 'DISTRITO BUGA', 'Calima Darién', 'Estacion de servicio Calima 1 (entrada la union y buga)', 3.949067, -76.471882],
  ['72', 'P1', 'DISTRITO BUGA', 'Yotoco', 'Carera 5 con calle 5  Barrio Centenario', 3.86139, -76.384752],
  ['73', 'P2', 'DISTRITO BUGA', 'Yotoco', 'Carrera 10 con Calle 5 Barrio Jorge Eliecer', 3.86027, -76.379717],
  ['74', 'P3', 'DISTRITO BUGA', 'Yotoco', 'Carera 3 con calle 6 Barrio Santa Centanario', 3.861095, -76.386709],
  ['75', 'P1', 'DISTRITO BUGA', 'Restrepo', 'Carrera 9 con calle 11 Barrio Cnetro', 3.4912, -76.3111],
  ['76', 'P2', 'DISTRITO BUGA', 'Restrepo', 'Calle 10 con carrera 10 Barrio Centro', 3.4911, -76.3111],
  ['77', 'P3', 'DISTRITO BUGA', 'Restrepo', 'Calle 11 con carrera 14A Barrio los ALPES', 3.4816, -76.3112],
  ['78', 'P1', 'DISTRITO BUGA', 'Ginebra', 'Calle 4 con Carrera 2', 3.724254, -76.26933],
  ['79', 'P2', 'DISTRITO BUGA', 'Ginebra', 'Carrera 3 Calle 4', 3.724066, -76.268941],
  ['80', 'P3', 'DISTRITO BUGA', 'Ginebra', 'Carrera 2 con Calle 6', 3.72507, -76.268187],
  ['81', 'P1', 'DISTRITO BUGA', 'Guacarí', 'Carrera 5B SUR con calle 1 Barrio el Cairo', 3.754149, -76.327292],
  ['82', 'P2', 'DISTRITO BUGA', 'Guacarí', 'Calle 12 con carrera 5 Barrio Limonar', 3.765079, -76.337407],
  ['83', 'P3', 'DISTRITO BUGA', 'Guacarí', 'Calle 12 con carrera 4 Barrio Ceivas', 3.760884, -76.330829],
  ['84', 'P1', 'DISTRITO TULUÁ', 'Tuluá', 'Carrera 26 con calle 26 Barrio Centro', 4.085566, -76.197079],
  ['85', 'P2', 'DISTRITO TULUÁ', 'Tuluá', 'Carrera 29 con calle 15 Barrio Moralito', 4.092501, -76.19047],
  ['86', 'P3', 'DISTRITO TULUÁ', 'Tuluá', 'Carrera 38 con calle 26 Barrio San Vicente', 4.083255, -76.187895],
  ['87', 'P4', 'DISTRITO TULUÁ', 'Tuluá', 'Carrera 14 con Calle 25 Barrio las Delicias', 4.089932, -76.20489],
  ['88', 'P5', 'DISTRITO TULUÁ', 'Tuluá', 'AV. PRINCIPAL CGTO. AGUACLARA Corregimiento Agua clara', 4.116129, -76.194848],
  ['89', 'P6', 'DISTRITO TULUÁ', 'Tuluá', 'AV. PRINCIPAL CALLEJON MEJORAL CGTO. NARIÑO', 4.116129, -76.194848],
  ['90', 'P7', 'DISTRITO TULUÁ', 'Tuluá', 'Trasversal 12 Carrera 28ª Corregimiento Agua clara', 4.102063, -76.193317],
  ['91', 'P1', 'DISTRITO TULUÁ', 'Rio Frio', 'Carrera 12 calle 5 Barrio el Centro', 4.156362, -76.289777],
  ['92', 'P2', 'DISTRITO TULUÁ', 'Rio Frio', 'Carrera 11 calle 6 Barrio el Centro', 4.156769, -76.288747],
  ['93', 'P3', 'DISTRITO TULUÁ', 'Rio Frio', 'Carrera 13 calle 8 Barrio el Belén', 4.158952, -76.289595],
  ['94', 'P4', 'DISTRITO TULUÁ', 'Rio Frio', 'Carrera 10 calle 7 Barrio el Centro', 4.157197, -76.287535],
  ['95', 'P5', 'DISTRITO TULUÁ', 'Rio Frio', 'Carrera 13 calle 11 Barrio fundevir', 4.16214, -76.28828],
  ['96', 'P1', 'DISTRITO TULUÁ', 'Bugalagrande', 'Carrera 4 con calle 4 Barrio la Planta', 4.210218, -76.15672],
  ['97', 'P2', 'DISTRITO TULUÁ', 'Bugalagrande', 'Carrera  5 con calle 5 Barrio el Centro', 4.211327, -76.156842],
  ['98', 'P3', 'DISTRITO TULUÁ', 'Bugalagrande', 'Carrera 1ª  con calle 5 Barrio la Planta', 4.209348, -76.154074],
  ['99', 'P4', 'DISTRITO TULUÁ', 'Bugalagrande', 'Carrera 5ª con calle 11 Barrio Gualcoche', 4.215265, -76.152539],
  ['100', 'P1', 'DISTRITO TULUÁ', 'Andalucía', 'Carrera 4 con calle 14 Barrio centro', 4.170328, -76.166462],
  ['101', 'P2', 'DISTRITO TULUÁ', 'Andalucía', 'Carrera 5 con calle 18 Barrio Estadio', 4.173624, -76.164831],
  ['102', 'P3', 'DISTRITO TULUÁ', 'Andalucía', 'Carrera 5 con calle 5 Barrio Reubicación', 4.177448, -76.163206],
  ['103', 'P4', 'DISTRITO TULUÁ', 'Andalucía', 'Carrera 4 con calle 5 Barrio San Vicente', 4.163516, -76.170062],
  ['104', 'P5', 'DISTRITO TULUÁ', 'Andalucía', 'Cra 10 con calle 24  Barrio floresta 2', 4.18093, -76.16489],
  ['105', 'P1', 'DISTRITO TULUÁ', 'Trujillo', 'Carrera 20 con Calle 19 Barrio Centro', 4.212415, -76.319153],
  ['106', 'P2', 'DISTRITO TULUÁ', 'Trujillo', 'Carrera 20 con Calle 21 Barrio el Centro', 4.213822, -76.318388],
  ['107', 'P3', 'DISTRITO TULUÁ', 'Trujillo', 'Carrera 21 con 17 Calle Barrio San Jorge', 4.211275, -76.321456],
  ['108', 'P4', 'DISTRITO TULUÁ', 'Trujillo', 'Carrera 21 con Calle 18 Barrio el Refugio', 4.211479, -76.320115],
  ['109', 'P5', 'DISTRITO TULUÁ', 'Trujillo', 'Carrera 18 calle 15 Barrio La Paz', 4.208029, -76.320244],
  ['110', 'P1', 'DISTRITO PALMIRA', 'Florida', 'Vía Chocito con Carrera 16 A Barrio Pubenza', 3.316961, -76.237407],
  ['111', 'P2', 'DISTRITO PALMIRA', 'Florida', 'Vía Miranda con Carrera 17 Barrio El Fajardo', 3.319106, -76.237625],
  ['112', 'P3', 'DISTRITO PALMIRA', 'Florida', 'Calle 5 con Carrera 19 Barrio Nuevo Horizonte', 3.321755, -76.237535],
  ['113', 'P4', 'DISTRITO PALMIRA', 'Florida', 'Barrio Urbanización Molinos del Viento', 3.324883, -76.220414],
  ['114', 'P5', 'DISTRITO PALMIRA', 'Florida', 'Vía Pradera Ingreso al Casco Urbano Barrio Urbanización Maria Luisa', 3.335766, null],
  ['115', 'P6', 'DISTRITO PALMIRA', 'Florida', 'Calle 13 con Carrera 21 Barrio Villa Nancy', 3.329048, -76.235668],
  ['116', 'P7', 'DISTRITO PALMIRA', 'Florida', 'Calle 7 con Carrera 13 A', 3.321087, -76.232136],
  ['117', 'P8', 'DISTRITO PALMIRA', 'Florida', 'Calle 10 con Carrera 19', 3.325663, -76.23545],
  ['118', 'P9', 'DISTRITO PALMIRA', 'Florida', 'Calle 11 con Carrera 6A Barrio Los Almendros', 3.321249, -76.225651],
  ['119', 'P10', 'DISTRITO PALMIRA', 'Florida', 'Vía Pedregal Coliseo del Corregimiento Pedregal', 3.31281, -76.215222],
  ['120', 'P1', 'DISTRITO PALMIRA', 'Cerrito', 'Carrera 13 con calle 9 Barrio Cabal Molina', 3.686231, -76.31408],
  ['121', 'P2', 'DISTRITO PALMIRA', 'Cerrito', 'Carrera 12 con calle 6 Barrio la Estrella', 3.6833, -76.3129],
  ['122', 'P3', 'DISTRITO PALMIRA', 'Cerrito', 'Carrera 10 con calle 17 Barrio santa barbara', 3.68439, -76.312063],
  ['123', 'P4', 'DISTRITO PALMIRA', 'Cerrito', 'Carrera 14 con calle 12 Barrio la Esperanza', 3.689031, -76.314995],
  ['124', 'P5', 'DISTRITO PALMIRA', 'Cerrito', 'Carrera 12 con calle 8 Barrio el Centro', 3.685364, -76.313021],
  ['125', 'P1', 'DISTRITO PALMIRA', 'Pradera', 'calle 2N carrera 2 Barrio berlin, cancha de baskes', 3.420114, -76.232608],
  ['126', 'P2', 'DISTRITO PALMIRA', 'Pradera', 'carrera 5 calle 5 N Barrio Mnuel Jose Ramirez', 3.41717049, -76.238323],
  ['127', 'P3', 'DISTRITO PALMIRA', 'Pradera', 'carrera 9 calle 2 Barrio EL Bolito', 3.421397, -76.23854],
  ['128', 'P4', 'DISTRITO PALMIRA', 'Pradera', 'carrera 11 calle 2 Barrio EL Bolito', 3.422796, -76.239749],
  ['129', 'P5', 'DISTRITO PALMIRA', 'Pradera', 'manzana 2 cal 1 A Barrio La Vegas', 3.422928, -76.235792],
  ['130', 'P6', 'DISTRITO PALMIRA', 'Pradera', 'carrera 8 calle 2 Barrio El Berlin', 3.406773, -76.344097],
  ['131', 'P7', 'DISTRITO PALMIRA', 'Pradera', 'carrera 6 calle 1 N Barrio El Berlin', 3.420628, -76.23468],
  ['132', 'P8', 'DISTRITO PALMIRA', 'Pradera', 'calle 1 carrera 5 Barrio La Silbadora', 3.420157, -76.234512],
  ['133', 'P9', 'DISTRITO PALMIRA', 'Pradera', 'carrera 3 calle 4 N Barrio Manuel Jose Ramirez', 3.416127, -76.236298],
  ['134', 'P10', 'DISTRITO PALMIRA', 'Pradera', 'TRASVERSAL 7 CON CARRERA 20', 3.424012, -76.24667],
  ['135', 'P1', 'DISTRITO MECAL', 'Cali', 'Carrera 1 Calle 56 Comfandi Flora Industrial', 3.47847987, -76.5016237],
  ['136', 'P2', 'DISTRITO MECAL', 'Cali', 'Carrera 2 Calle 70 Rivera Dos', 3.47265701, -76.4871592],
  ['137', 'P3', 'DISTRITO MECAL', 'Cali', 'Carrera 1C Calle 58A Iglesia Torres de Comfandi', 3.47508342, -76.4975561],
  ['138', 'P4', 'DISTRITO MECAL', 'Cali', 'Cra 2 Calle 56 Dari SENA Situado Fiscal', 3.46902954, -76.4986896],
  ['139', 'P5', 'DISTRITO MECAL', 'Cali', 'Cra 1D Calle 56 Lod Andes', 3.47278171, -76.4995187],
  ['140', 'P1', 'DISTRITO MECAL', 'Candelaria', 'Barrio Santa Ana Carrera 19 Calle 7A E Via Buchitolo', 3.3907861111111113, -76.38335277777779],
  ['141', 'P2', 'DISTRITO MECAL', 'Candelaria', 'Separador Vial sobre calle 16 Frente de Don Buñuelo', 3.3980194444444445, -76.38380555555557],
  ['142', 'P3', 'DISTRITO MECAL', 'Candelaria', 'Callejon Guales (Salida Calle 16)', 3.3999805555555556, -76.38827500000001],
  ['143', 'P4', 'DISTRITO MECAL', 'Candelaria', 'Via Florida - Cali Rotonda Pio Pio', 3.404583333333333, -76.39887777777778],
  ['144', 'P5', 'DISTRITO MECAL', 'Candelaria', 'Calle 14 Manzanares', 3.403211111111111, -76.45434722222222],
  ['145', 'P6', 'DISTRITO MECAL', 'Candelaria', 'Manzanares Parque 24-25 MZ 11 Sector 24 (Cancha de Patinaje)', 3.4047111111111112, -76.44224444444446],
  ['146', 'P7', 'DISTRITO MECAL', 'Candelaria', 'Calle 16 con Carrera 18 Oeste Manzanares 23', 3.4058416666666664, -76.43766111111111],
  ['147', 'P8', 'DISTRITO MECAL', 'Candelaria', 'Via Cali - Candelaria altura callejopn entrasa empresa Refinal', 3.244369, -76.26478],
  ['148', 'P1', 'DISTRITO MECAL', 'La Cumbre', 'Carrera 2 Calle 1 La Espiga', 3.648038, -76.56728],
  ['149', 'P2', 'DISTRITO MECAL', 'La Cumbre', 'Calle 3 Carrera 7 Barrio Villa Nueva', 3.65024, -76.569679],
  ['150', 'P1', 'DISTRITO MECAL', 'Vijes', 'Carrera 7 Calle 8 Sector 3 esqinas', 3.702446, -76.439849],
  ['151', 'P2', 'DISTRITO MECAL', 'Vijes', 'Carerea 1 Calle 8 Supermeercado el Vecino', 3.69784, -76.441472],
  ['152', 'P1', 'DISTRITO DAGUA', 'Dagua', 'Carrera 12 con carretera Dagua Lobo Guerrero', 3.667088888888889, -76.68988888888889],
  ['153', 'P2', 'DISTRITO DAGUA', 'Dagua', 'Carrera 21 con calle 10 Barrio Ricaurte', 3.6577305555555553, -76.69373055555556],
  ['154', 'P3', 'DISTRITO DAGUA', 'Dagua', 'Calle 10 con Carrera 11 - Alcaldia', 3.656722, -76.694107],
  ['155', 'P4', 'DISTRITO DAGUA', 'Dagua', 'Calle 15 con Carretera Dagua - Calio', 3.64855, -76.6854388888889],
  ['156', 'P5', 'DISTRITO DAGUA', 'Dagua', 'Carrera 13 con calle 9 Barrio la Paz', 3.657525, -76.691811],
  ['157', 'P6', 'DISTRITO DAGUA', 'Dagua', 'Carrera 13 con calle 4 Barrio el Llanito', 3.660009, -76.691049],
  ['158', 'P7', 'DISTRITO DAGUA', 'Dagua', 'Carrera 13 con calle 5 Barrio los Álamos', 3.657065, -76.688485],
  ['159', 'P8', 'DISTRITO DAGUA', 'Dagua', 'Carrera 21 con calle 10 Barrio Ricaurte', 3.656101, -76.686543],
  ['160', 'P9', 'DISTRITO DAGUA', 'Dagua', 'Carrera 15 con calle 7 Barrio la Cabaña', 3.658039, -76.689965],
  ['161', 'P10', 'DISTRITO DAGUA', 'Dagua', 'Carrera 21 con calle 7 Barrio Remedios', 3.657889, -76.685996],
];

function buildSitesForFirestore() {
  const sites = [];
  lprRows.forEach((row, index) => {
    const [siteCode, distrito, municipio, address, coordsDms, camerasCount] = row;
    const [lat, lng] = parseDMS(coordsDms);
    sites.push({
      id: `lpr-${index + 1}`,
      site_code: siteCode,
      site_type: 'lpr',
      distrito: distrito.toUpperCase(),
      municipio: municipio.toUpperCase(),
      name: siteCode,
      address,
      latitude: lat,
      longitude: lng,
      cameras_count: camerasCount ?? 0,
      description: '',
    });
  });
  cotejoFacialRows.forEach((row, index) => {
    const [siteCode, distrito, municipio, address, coordsDms] = row;
    const [lat, lng] = parseDMS(coordsDms);
    sites.push({
      id: `f-${index + 1}`,
      site_code: siteCode,
      site_type: 'cotejo_facial',
      distrito: distrito.toUpperCase(),
      municipio: municipio.toUpperCase(),
      name: siteCode,
      address,
      latitude: lat,
      longitude: lng,
      cameras_count: 0,
      description: '',
    });
  });
  
  ptzRows.forEach((row) => {
    const [numero, nemotecnia, distrito, municipio, address, lat, lng] = row;
    sites.push({
      id: `ptz-${numero}`,
      site_code: `PTZ ${numero}`,
      site_type: 'ptz',
      distrito: distrito.toUpperCase(),
      municipio: municipio.toUpperCase(),
      name: `PTZ ${numero}`,
      address,
      latitude: lat,
      longitude: lng,
      cameras_count: 1,
      description: `Nemotecnia: ${nemotecnia}`,
    });
  });
  return sites;
}

export { buildSitesForFirestore, parseDMS, lprRows, cotejoFacialRows, ptzRows };
